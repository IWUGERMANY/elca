"undefined"!=typeof jQuery&&$(window).load(function(){jBlibs.App.init({debug:!1,updateHashUrlCssClass:"page",initialize:function(){elca.msgBus.registerHandler("ifcViewer.selection-changed",function(event){console.debug("Triggering backend"),jBlibs.App.query("/ifcViewer/main/elements/?ifcGuid="+event.guid)})},controllers:{ifcViewer:{debug:!0,urls:/^\/ifcViewer/,controls:{"a:not(.no-xhr):not([rel])":{click:function(e){return $(this).attr("href")}}},initialize:function(){},views:{"#viewerContent.ifc-viewer":"prepareContent"},prepareContent:function($context){require(["ElcaIfcViewer"],function(ElcaIfcViewer){var lastedLoadedGuid,viewer=new ElcaIfcViewer({src:$context.data("src"),debug:!0,onLoadedCallback:function(bimSurfer,model){bimSurfer.on("selection-changed",function(selected){if(selected.objects.length>0){var oid=selected.objects[0],guid=viewer.convertOidToGuid(oid);if(lastedLoadedGuid&&lastedLoadedGuid===guid)return void console.log("Current loaded element equals the selected",guid);console.log("Selection changed for "+oid+" ["+guid+"]"),elca.msgBus.submit("ifcViewer.selection-changed",{guid:guid})}})}});elca.msgBus.registerHandler("elca.element-loaded",function(message){message.guid?(lastedLoadedGuid=message.guid,viewer.viewElement(message.guid)):console.error("ifcViewer received an invalid message: message.guid not set",message)})})}}}})});